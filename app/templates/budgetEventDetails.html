{% extends "base.html" %}
{% block title %}TACCI{% endblock %}
{% block content %}

<style>
    .past-events-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    /* ✅ Banner with overlay */
    .event-banner-wrapper {
        position: relative;
        width: 100%;
        height: 600px;
        margin-bottom: 20px;
    }

    .event-banner {
        width: 100%;
        height: 100%;
        object-fit: fill;
        border-radius: 10px;
        display: block;
    }

    .event-banner-overlay {
        position: absolute;
        inset: 0;
        background: rgba(17, 24, 39, 0.55);
        border-radius: 10px;
    }

    .event-title {
        font-size: 28px;
        font-weight: 700;
        margin: 20px 0;
        color: #111827;
    }

    .event-description {
        font-size: 16px;
        color: #6b7280;
        margin-bottom: 30px;
    }

    /* ✅ Responsive Grid for Cards */
    .budget-card-container {
        display: grid;
        grid-template-columns: 1fr;
        /* default: mobile first */
        gap: 30px;
    }

    /* Tablets/iPads: 1 Card */
    @media (min-width: 480px) and (max-width: 768px) {
        .budget-card-container {
            grid-template-columns: 1fr;
        }
    }

    /* Small Laptops: 2 Cards */
    @media (min-width: 768px) and (max-width: 1024px) {
        .budget-card-container {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    /* Desktops: 3 Cards */
    @media (min-width: 1024px) and (max-width: 1200px) {
        .budget-card-container {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    /* Extra-large: 3 Cards */
    @media (min-width: 1200px) {
        .budget-card-container {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    .card {
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        position: relative;
        border: none;
    }

    .card img {
        width: 100%;
        height: 280px;
        object-fit: cover;
        border-radius: 8px;
        display: block;
    }

    .budget-card-content {
        position: relative;
        margin: -60px 10px 0 10px;
        background: #fff;
        padding: 10px;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.1);
        border-radius: 6px;
        z-index: 10;
        border: 1px solid rgba(0, 0, 0, 0.33);
    }

    .budget-description {
        font-size: 14px;
        color: #374151;
        margin: 0;
        text-align: justify;
        max-height: 80px;
        overflow: hidden;
        transition: max-height 0.5s ease, padding 0.3s ease;
    }

    .budget-description.expanded {
        max-height: 500px;
    }

    .read-more-btn {
        background: none;
        border: none;
        color: #2563eb;
        font-size: 13px;
        cursor: pointer;
        margin-top: 5px;
        transition: color 0.2s ease;
    }

    .read-more-btn:hover {
        color: #1d4ed8;
    }

    /* fallback card (when no images uploaded) */
    .card.no-image .budget-card-content {
        margin: 0;
        box-shadow: none;
        border: 1px solid #e5e7eb;
    }
</style>

<div class="tp-breadcrumb-area tp-breadcrumb-spacing bg-position pt-200 h-[70vh]"
    data-background="/static/images/hero/banner.jpg" style="margin-top: 0rem"></div>

<div class="past-events-container pb-10">
    <!-- ✅ Banner -->
    <div class="event-banner-wrapper">
        <img class="event-banner" src="{{ event.banner_image_path or '/static/images/hero/banner.jpg' }}"
            alt="Event Banner" onerror="this.src='/static/images/hero/banner.jpg'">
        <div class="event-banner-overlay"></div>
    </div>

    <h1 class="event-title">{{ event.title }}</h1>

    <!-- ✅ Responsive Card Grid -->
    <div class="budget-card-container">
        {% for img in images %}
        <div class="card">
            <a href="{{ img.image_path }}" target="_blank">
                <img src="{{ img.image_path }}" alt="{{ img.description or 'Budget Image' }}"
                    onerror="this.src='/static/images/hero/banner.jpg'">
            </a>
            <div class="budget-card-content">
                <p class="budget-description">{{ img.description or '' }}</p>
                {% if img.description and img.description|length > 120 %}
                <button class="read-more-btn">Read More</button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        {% if not images or images|length == 0 %}
        <div class="card no-image" style="grid-column: span 3;">
            <div class="budget-card-content">
                <p class="budget-description">No images uploaded for this event.</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- ✅ Script for Read More/Less inside cards -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const buttons = document.querySelectorAll(".read-more-btn");

        buttons.forEach(btn => {
            btn.addEventListener("click", () => {
                const desc = btn.previousElementSibling;
                desc.classList.toggle("expanded");
                btn.textContent = desc.classList.contains("expanded") ? "Read Less" : "Read More";
            });
        });
    });
</script>

{% endblock %}